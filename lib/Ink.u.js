// Ink.js
// By Daniel R. (sadasant.com)
// License: http://opensource.org/licenses/mit-license.php
// Homepage: https://github.com/sadasant/Ink.js
~function(e,t,n,r){function w(){if(d)return c(w);c(w);var e;for(e in i)i[e]&&(a.save(),i[e].draw(),a.restore());l.drawImage(u,0,0)}function E(e){i[e.id]=e}function S(e){e&&(o[e.id]=!0,delete i[e.id])}function T(e){e||(e={});var t=Object.create(x.geometrics);return t.id=""+(s+=1),t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t.fill=e.fill||"rgba(0, 0, 0, 0.2)",t.border_color=e.border_color||"rgba(0, 0, 0, 0.2)",t.border_width=e.border_width||0,t.rotation=0,t.speed={x:0,y:0},t.maxSpeed={x:10,y:10},t.infiniteScope=null,t.colliders=[],t.draw=N,t.afterDraw=r,t}function N(){this.infiniteScope&&this.foreverInScope(),(this.speed.x||this.speed.y)&&this.repos(),a.translate(this.x,this.y),this.rotation&&a.rotate(this.rotation),this.colliders.length&&this.collide(),a.fillStyle=this.fill,a.strokeStyle=this.border_color,a.lineWidth=this.border_width,a.fillRect(this.x,this.y,this.width,this.height),this.afterDraw&&this.afterDraw()}function C(e){e||(e={});var t=Object.create(x.geometrics);return t.id=(s+=1).toString(),t.x=e.x||0,t.y=e.y||0,t.r=e.r||0,t.fill=e.fill||"rgba(255, 255, 255, 0.3)",t.border_color=e.border_color||"rgba(0, 0, 0, 0.2)",t.border_width=e.border_width||0,t.rotation=0,t.speed={x:0,y:0},t.maxSpeed={x:10,y:10},t.infiniteScope=null,t.colliders=[],t.draw=k,t.afterDraw=r,t}function k(){this.infiniteScope&&this.foreverInScope(),(this.speed.x||this.speed.y)&&this.repos(),a.translate(this.x,this.y),this.rotation&&a.rotate(this.rotation),this.colliders.length&&this.collide(),a.fillStyle=this.fill,a.strokeStyle=this.border_color,a.lineWidth=this.border_width,a.beginPath(),a.arc(0,0,this.r,0,m),a.closePath(),a.stroke(),a.fill(),this.afterDraw&&this.afterDraw()}function L(e){e||(e={});var t=Object.create(x.geometrics);return t.id=(s+=1).toString(),t.x=e.x,t.y=e.y,t.path=e.path||[],t.fill=e.fill||"rgba(255, 255, 255, 0.3)",t.border_color=e.border_color||"rgba(0, 0, 0, 0.2)",t.border_width=e.border_width||0,t.rotation=0,t.speed={x:0,y:0},t.maxSpeed={x:10,y:10},t.infiniteScope=null,t.colliders=[],t.draw=A,t.afterDraw=r,t}function A(){this.infiniteScope&&this.foreverInScope(),(this.speed.x||this.speed.y)&&this.repos(),a.translate(this.x,this.y),this.rotation&&a.rotate(this.rotation),this.colliders.length&&this.collide(),a.fillStyle=this.fill,a.strokeStyle=this.border_color,a.lineWidth=this.border_width,a.beginPath();var e=0,t=this.path.length,n;for(;e!==t;e+=1)n=this.path[e],e?a.lineTo(n[0],n[1]):a.moveTo(n[0],n[1]),n.length===6&&a.quadraticCurveTo(n[2],n[3],n[4],n[5]);a.closePath(),a.stroke(),a.fill(),this.afterDraw&&this.afterDraw()}function O(e){e||(e={});var t;switch(e.type){case"LINEAR":t=a.createLinearGradient(e.x1,e.y1,e.width,e.height);break;case"RADIAL":t=a.createRadialGradient(e.x1,e.y1,e.r1,e.x2,e.y2,e.r2)}return t.colors=x.grad.colors,t}function M(){d=!1,p||(p=!0,w())}function _(e){e||(e={}),d=!0,i={},s=0,o={},this.dcan=f=this.dcan||t.getElementById(e.id||"canvas"),this.dcon=l=this.dcon||f.getContext("2d"),this.can=u=this.can||t.createElement("canvas"),this.con=a=this.con||u.getContext("2d"),u.height=f.height=e.height||h.h,u.width=f.width=e.width||h.w;if(!e.width||!e.height)t.body.style.overflow="hidden",f.style.margin="-8px -8px";return this.center={x:h.w/2,y:h.h/2},e.clear&&D.draw(new D.Rect({x:0,y:0,width:u.width,height:u.height,fill:e.clear}),1),setTimeout(M,100)}var i={},s=0,o={},u,a,f,l,c,h,p,d,v=n.PI/180,m=n.PI*2,g=n.cos,y=n.sin,b=n.abs;c=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)}}().bind(e),h=function(){return{w:e.innerWidth||t.documentElement&&t.documentElement.offsetWidth||t.body&&t.body.offsetWidth||630,h:e.innerHeight||t.documentElement&&t.documentElement.offsetHeight||t.body&&t.body.offsetHeight||460}}();var x={geometrics:{foreverInScope:function(){this.x>u.width-10&&(this.x-=u.width),this.x<-10&&(this.x+=u.width-10),this.y>u.height&&(this.y-=u.height),this.y<-10&&(this.y+=u.height)},rotateTo:function(e){this.rotation=e*v},accel:function(e,t){t&&(this.maxSpeed.x=t,this.maxSpeed.y=t);if(this.rotateInEdge){var n=this.rotation,r=-e*y(n),i=e*g(n);this.speed.x+=r,this.speed.y+=i}else this.speed.x+=e,this.speed.y+=e;var s={x:b(this.speed.x),y:b(this.speed.y)};s.x>this.maxSpeed.x&&(this.speed.x=s.x/this.speed.x*this.maxSpeed.x),s.y>this.maxSpeed.y&&(this.speed.y=s.y/this.speed.y*this.maxSpeed.y)},stop:function(){this.speed.x=0,this.speed.y=0},repos:function(){if(this.rotateInEdge)this.x-=this.speed.x,this.y-=this.speed.y;else{var e=this.rotation;this.x+=this.speed.x*y(e),this.y-=this.speed.y*g(e)}},addCollider:function(e){this.colliders[this.colliders.length]=e},onCollide:function(){this.fill="rgba(255, 0, 0, 0.3)",this.stroke="rgba(255, 0, 0, 1)"},collideArea:15,collide:function(){var e=this.colliders,t,n=0,r=e.length,i,s;for(;n!==r;n+=1)if(t=e[n])i=b(t.x-this.x),s=b(t.y-this.y),i<this.collideArea&&s<this.collideArea&&(o[t.id]?delete this.colliders[n]:this.onCollide(t))}},grad:{colors:function(e){var t=0,n=e.length;for(;t!==n;t+=1){var r=e[t];this.addColorStop(r[0],r[1])}return this}}},D=e.Ink={VERSION:"0.3.33",can:null,con:null,init:_,draw:E,remove:S,Path:L,Rect:T,Circ:C,grad:O,reqAF:c}}(window,document,Math);