// Ink.js
// By Daniel R. (sadasant.com)
// License: http://opensource.org/licenses/mit-license.php
// Homepage: https://github.com/sadasant/Ink.js
(function(){function n(){return{w:a.innerWidth||b.documentElement&&b.documentElement.offsetWidth||b.body&&b.body.offsetWidth||630,h:a.innerHeight||b.documentElement&&b.documentElement.offsetHeight||b.body&&b.body.offsetHeight||460}}function o(){for(var a in d)d[a]&&(h.save(),d[a].draw(),h.restore())}function p(a){d[a.id]=a}function q(a){a&&(f[f.length]=a.id,delete d[a.id])}function r(a,b){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])}function s(){}function t(a){this.id=(++e).toString(),this.x=a.x||0,this.y=a.y||0,this.width=a.width,this.height=a.height,this.fill=a.fill||"rgba(0, 0, 0, 0.2)",this.stroke=a.stroke||"rgba(0, 0, 0, 0.2)",this.maxSpeed={x:10,y:10},this.draw=function(){h.fillStyle=this.fill,h.fillRect(this.x,this.y,this.width,this.height)}}function u(a){r(s.prototype,this),this.id=(++e).toString(),this.x=a.x||0,this.y=a.y||0,this.r=a.r||0,this.fill=a.fill||"rgba(255, 255, 255, 0.3)",this.stroke=a.stroke||"rgba(255, 255, 255, 1)",this.rotation=0,this.speed={x:0,y:0},this.maxSpeed={x:10,y:10},this.infiniteScope=null,this.colliders=[],this.draw=function(){this.infiniteScope&&this.foreverInScope(),(this.speed.x||this.speed.y)&&this.repos(),h.translate(this.x,this.y),this.rotation&&h.rotate(this.rotation),this.colliders.length&&this.collide(),h.fillStyle=this.fill,h.strokeStyle=this.stroke,h.beginPath(),h.arc(0,0,this.r,0,j),h.closePath(),h.stroke(),h.fill()}}function v(a){r(s.prototype,this),this.id=(++e).toString(),this.x=a.x||0,this.y=a.y||0,this.v=a.v||[],this.fill=a.fill||"rgba(255, 255, 255, 0.3)",this.stroke=a.stroke||"rgba(255, 255, 255, 1)",this.rotation=0,this.speed={x:0,y:0},this.maxSpeed={x:10,y:10},this.infiniteScope=null,this.colliders=[],this.draw=function(){this.infiniteScope&&this.foreverInScope(),(this.speed.x||this.speed.y)&&this.repos(),h.translate(this.x,this.y),this.rotation&&h.rotate(this.rotation),this.colliders.length&&this.collide(),h.fillStyle=this.fill,h.strokeStyle=this.stroke,h.beginPath();for(var a=0;a<this.v.length;a++)a?h.lineTo(this.v[a][0],this.v[a][1]):h.moveTo(this.v[a][0],this.v[a][1]);h.closePath(),h.stroke(),h.fill()}}function w(a){d={},e=0,f=[],this.canvas=g=this.can||b.getElementById(a.id||"canvas"),this.context=h=this.con||g.getContext(a.d||"2d");var c=n();g.width=a.width||c.w,g.height=a.height||c.h,this.center={x:c.w/2,y:c.h/2};var i=a.clear!==undefined?a.clear:"rgba(0, 0, 0, 1)";i&&x.draw(new x.Rect({width:g.width,height:g.height,fill:i}),1),this.interval&&clearInterval(this.interval),this.interval=setInterval(o,this.frame)}var a=this,b=document,c=Math,d={},e=0,f=[],g,h,i=c.PI/180,j=c.PI*2,k=c.cos,l=c.sin,m=c.abs;s.prototype={foreverInScope:function(){this.x>g.width-10&&(this.x-=g.width),this.x<-10&&(this.x+=g.width-10),this.y>g.height&&(this.y-=g.height),this.y<-10&&(this.y+=g.height)},rotateTo:function(a){this.rotation=a*i},run:function(a,b){b&&(this.maxSpeed.x=b,this.maxSpeed.y=b);if(this.rotateInEdge){var c=this.rotation,d=-a*l(c),e=a*k(c);this.speed.x+=d,this.speed.y+=e}else this.speed.x+=a,this.speed.y+=a;var f={x:m(this.speed.x),y:m(this.speed.y)};f.x>this.maxSpeed.x&&(this.speed.x=f.x/this.speed.x*this.maxSpeed.x),f.y>this.maxSpeed.y&&(this.speed.y=f.y/this.speed.y*this.maxSpeed.y)},repos:function(){if(this.rotateInEdge)this.x-=this.speed.x,this.y-=this.speed.y;else{var a=this.rotation;this.x+=this.speed.x*l(a),this.y-=this.speed.y*k(a)}},addCollider:function(a){this.colliders[this.colliders.length]=a},onCollide:function(){this.fill="rgba(255, 0, 0, 0.3)",this.stroke="rgba(255, 0, 0, 1)"},collideArea:15,collide:function(){var a=this.colliders;for(var b=0;b<a.length;b++)if(a[b]){var c=m(a[b].x-this.x),d=m(a[b].y-this.y);c<this.collideArea&&d<this.collideArea&&(~f.indexOf(a[b].id)?delete this.colliders[b]:this.onCollide(a[b]))}}};var x=a.Ink={VERSION:"0.0.5",canvas:null,context:null,start:w,draw:p,remove:q,fork:r,Path:v,Rect:t,Circle:u,frame:31}})();