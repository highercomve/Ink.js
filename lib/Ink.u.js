// Ink.js
// By Daniel R. (sadasant.com)
// License: http://opensource.org/licenses/mit-license.php
// Homepage: https://github.com/sadasant/Ink.js
(function(){function n(){return{w:a.innerWidth||b.documentElement&&b.documentElement.offsetWidth||b.body&&b.body.offsetWidth||630,h:a.innerHeight||b.documentElement&&b.documentElement.offsetHeight||b.body&&b.body.offsetHeight||460}}function o(){for(var a in d)d[a]&&(h.save(),d[a].draw(),h.restore())}function p(a){d[a.id]=a}function q(a){a&&(f[f.length]=a.id,delete d[a.id])}function r(a,b){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])}function t(a,b,c,d,f,g){r(s.geometrics,this),this.id=(++e).toString(),this.x=a,this.y=b,this.width=c,this.height=d,this.fill=f||"rgba(0, 0, 0, 0.2)",this.stroke=g||"rgba(0, 0, 0, 0.2)",this.rotation=0,this.speed={x:0,y:0},this.maxSpeed={x:10,y:10},this.infiniteScope=null,this.colliders=[],this.afterDraw=undefined,this.draw=function(){this.infiniteScope&&this.foreverInScope(),(this.speed.x||this.speed.y)&&this.repos(),h.translate(this.x,this.y),this.rotation&&h.rotate(this.rotation),this.colliders.length&&this.collide(),h.fillStyle=this.fill,h.strokeStyle=this.stroke,h.fillRect(this.x,this.y,this.width,this.height),this.afterDraw&&this.afterDraw()}}function u(a,b,c,d,f){r(s.geometrics,this),this.id=(++e).toString(),this.x=a||0,this.y=b||0,this.r=c||0,this.fill=d||"rgba(255, 255, 255, 0.3)",this.stroke=f||"rgba(255, 255, 255, 1)",this.rotation=0,this.speed={x:0,y:0},this.maxSpeed={x:10,y:10},this.infiniteScope=null,this.colliders=[],this.draw=function(){this.infiniteScope&&this.foreverInScope(),(this.speed.x||this.speed.y)&&this.repos(),h.translate(this.x,this.y),this.rotation&&h.rotate(this.rotation),this.colliders.length&&this.collide(),h.fillStyle=this.fill,h.strokeStyle=this.stroke,h.beginPath(),h.arc(0,0,this.r,0,j),h.closePath(),h.stroke(),h.fill()}}function v(a,b,c,d,f){r(s.geometrics,this),this.id=(++e).toString(),this.x=a,this.y=b,this.v=c||[],this.fill=d||"rgba(255, 255, 255, 0.3)",this.stroke=f||"rgba(255, 255, 255, 1)",this.rotation=0,this.speed={x:0,y:0},this.maxSpeed={x:10,y:10},this.infiniteScope=null,this.colliders=[],this.draw=function(){this.infiniteScope&&this.foreverInScope(),(this.speed.x||this.speed.y)&&this.repos(),h.translate(this.x,this.y),this.rotation&&h.rotate(this.rotation),this.colliders.length&&this.collide(),h.fillStyle=this.fill,h.strokeStyle=this.stroke,h.beginPath();for(var a=0,b=this.v.length;a<b;a++)a?h.lineTo(this.v[a][0],this.v[a][1]):h.moveTo(this.v[a][0],this.v[a][1]);h.closePath(),h.stroke(),h.fill()}}function w(a,b,c,d,e,f,g){var i;return a=="LINEAR"?i=h.createLinealGradient(b,c,d,e):a=="RADIAL"&&(i=h.createRadialGradient(b,c,d,e,f,g)),i.colors=s.grad.colors,i}function x(a,c,i,j){d={},e=0,f=[],this.can=g=this.can||b.getElementById(a||"canvas"),this.con=h=this.con||g.getContext("2d");var k=n();g.width=c||k.w,g.height=i||k.h;if(!c||!i)b.body.style.overflow="hidden",g.style.margin="-8px -8px";this.center={x:k.w/2,y:k.h/2},j=j!==undefined?j:"rgba(0, 0, 0, 1)",j&&y.draw(new y.Rect(0,0,g.width,g.height,j),1),this.interval&&clearInterval(this.interval),this.interval=setInterval(o,this.frame)}var a=this,b=document,c=Math,d={},e=0,f=[],g,h,i=c.PI/180,j=c.PI*2,k=c.cos,l=c.sin,m=c.abs,s={geometrics:{foreverInScope:function(){this.x>g.width-10&&(this.x-=g.width),this.x<-10&&(this.x+=g.width-10),this.y>g.height&&(this.y-=g.height),this.y<-10&&(this.y+=g.height)},rotateTo:function(a){this.rotation=a*i},accel:function(a,b){b&&(this.maxSpeed.x=b,this.maxSpeed.y=b);if(this.rotateInEdge){var c=this.rotation,d=-a*l(c),e=a*k(c);this.speed.x+=d,this.speed.y+=e}else this.speed.x+=a,this.speed.y+=a;var f={x:m(this.speed.x),y:m(this.speed.y)};f.x>this.maxSpeed.x&&(this.speed.x=f.x/this.speed.x*this.maxSpeed.x),f.y>this.maxSpeed.y&&(this.speed.y=f.y/this.speed.y*this.maxSpeed.y)},stop:function(){this.speed.x=0,this.speed.y=0},repos:function(){if(this.rotateInEdge)this.x-=this.speed.x,this.y-=this.speed.y;else{var a=this.rotation;this.x+=this.speed.x*l(a),this.y-=this.speed.y*k(a)}},addCollider:function(a){this.colliders[this.colliders.length]=a},onCollide:function(){this.fill="rgba(255, 0, 0, 0.3)",this.stroke="rgba(255, 0, 0, 1)"},collideArea:15,collide:function(){var a=this.colliders,b;for(var c=0,d=a.length;c<d;c++)if(b=a[c]){var e=m(b.x-this.x),g=m(b.y-this.y);e<this.collideArea&&g<this.collideArea&&(~f.indexOf(b.id)?delete this.colliders[c]:this.onCollide(b))}}},grad:{colors:function(a){for(var b=0,c=a.length;b<c;b++){var d=a[b];this.addColorStop(d[0],d[1])}return this}}},y=a.Ink={VERSION:"0.3.13",can:null,con:null,init:x,draw:p,remove:q,fork:r,Path:v,Rect:t,Circ:u,grad:w,frame:31}})();